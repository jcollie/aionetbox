library identifier: 'vapor@master', retriever: modernSCM(
    [$class: 'GitSCMSource',
    remote: 'https://github.com/vapor-ware/ci-shared.git',
    credentialsId: 'vio-bot-gh'])

toxPipeline{
  name = 'aionetbox'
  podTemplate = """
apiVersion: v1
kind: Pod
metadata:
  labels:
    jenkins/job: aionetbox
spec:
  containers:
  - name: python
    image: vaporio/jenkins-agent-python36:latest
    command:
    - cat
    tty: true
  nodeSelector:
    cloud.google.com/gke-nodepool: jenkins
  tolerations:
  - key: role
    operator: Equal
    value: jenkins
    effect: NoSchedule
"""

}


/*
    // Build and distribute a new package version to PyPi.
    stage('Publish to PyPi') {
      when {
        buildingTag()
      }
      environment {
        TWINE_USERNAME = 'vaporio'
        TWINE_PASSWORD = credentials('twine-password')
      }
      steps {
        container('python37-agent'){
          // publish to pypi
          sh 'tox -e publish'
        }
      }
    }
*/

